!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WasiMarshalling=e():t.WasiMarshalling=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var f,a=[],l=!1,s=-1;function y(){l&&f&&(l=!1,f.length?a=f.concat(a):s=-1,a.length&&p())}function p(){if(!l){var t=c(y);l=!0;for(var e=a.length;e;){for(f=a,a=[];++s<e;)f&&f[s].run();s=-1,e=a.length}f=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function b(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new h(t,e)),1!==a.length||l||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=b,o.addListener=b,o.once=b,o.off=b,o.removeListener=b,o.removeAllListeners=b,o.emit=b,o.prependListener=b,o.prependOnceListener=b,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){t.exports=n(5)},function(t,e,n){"use strict";(function(e,r){var o=n(3).version,i=n(4);t.exports="darwin"===e.platform?i.join(r,"flow-osx-v"+o,"flow"):"linux"===e.platform&&"x64"===e.arch?i.join(r,"flow-linux64-v"+o,"flow"):"win32"===e.platform&&"x64"===e.arch?i.join(r,"flow-win64-v"+o,"flow.exe"):null}).call(this,n(0),"/")},function(t){t.exports=JSON.parse('{"_args":[["flow-bin@0.128.0","/home/rtb/dev/public/rob-blackbourn/jetblack-wasi-marshaller"]],"_development":true,"_from":"flow-bin@0.128.0","_id":"flow-bin@0.128.0","_inBundle":false,"_integrity":"sha512-EnmMSOCrkx8F0r1+T1d1HODQ+ddy5yRfkT3CvwmK05IWZyXQy27OVdNwdXUWRqc0iMW75T4QkoXaVBYrMqfk+A==","_location":"/flow-bin","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"flow-bin@0.128.0","name":"flow-bin","escapedName":"flow-bin","rawSpec":"0.128.0","saveSpec":null,"fetchSpec":"0.128.0"},"_requiredBy":["#DEV:/"],"_resolved":"https://registry.npmjs.org/flow-bin/-/flow-bin-0.128.0.tgz","_spec":"0.128.0","_where":"/home/rtb/dev/public/rob-blackbourn/jetblack-wasi-marshaller","author":{"name":"Sindre Sorhus","email":"sindresorhus@gmail.com","url":"sindresorhus.com"},"bin":{"flow":"cli.js"},"bugs":{"url":"https://github.com/flowtype/flow-bin/issues"},"description":"Binary wrapper for Flow - A static type checker for JavaScript","engines":{"node":">=0.10.0"},"files":["flow-linux64-v*/flow","flow-osx-v*/flow","flow-win64-v*/flow.exe","vendor","cli.js","index.js","SHASUM256.txt"],"homepage":"https://github.com/flowtype/flow-bin#readme","keywords":["cli-app","cli","bin","binary","flow","facebook","type","inference","check","checker","javascript","js","wrapper"],"license":"MIT","name":"flow-bin","repository":{"type":"git","url":"git+https://github.com/flowtype/flow-bin.git"},"scripts":{"test":"echo \\"Error: Run \'make test\' instead.\\" && exit 1","verify":"shasum -c SHASUM256.txt"},"version":"0.128.0"}')},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var u=i>=0?arguments[i]:t.cwd();if("string"!=typeof u)throw new TypeError("Arguments to path.resolve must be strings");u&&(e=u+"/"+e,o="/"===u.charAt(0))}return(o?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!o).join("/"))||"."},e.normalize=function(t){var i=e.isAbsolute(t),u="/"===o(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!i).join("/"))||i||(t="."),t&&u&&(t+="/"),(i?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),i=r(n.split("/")),u=Math.min(o.length,i.length),c=u,f=0;f<u;f++)if(o[f]!==i[f]){c=f;break}var a=[];for(f=c;f<o.length;f++)a.push("..");return(a=a.concat(i.slice(c))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,o=!0,i=t.length-1;i>=1;--i)if(47===(e=t.charCodeAt(i))){if(!o){r=i;break}}else o=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,o=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!o){n=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,o=!0,i=0,u=t.length-1;u>=0;--u){var c=t.charCodeAt(u);if(47!==c)-1===r&&(o=!1,r=u+1),46===c?-1===e?e=u:1!==i&&(i=1):-1!==e&&(i=-1);else if(!o){n=u+1;break}}return-1===e||-1===r||0===i||1===i&&e===r-1&&e===n+1?"":t.slice(e,r)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(0))},function(t,e,n){"use strict";n.r(e),n.d(e,"MemoryManager",(function(){return r})),n.d(e,"Type",(function(){return i})),n.d(e,"ValueType",(function(){return p})),n.d(e,"Int8Type",(function(){return O})),n.d(e,"Int16Type",(function(){return j})),n.d(e,"Int32Type",(function(){return C})),n.d(e,"Int64Type",(function(){return B})),n.d(e,"Uint8Type",(function(){return Q})),n.d(e,"Uint16Type",(function(){return et})),n.d(e,"Uint32Type",(function(){return ft})),n.d(e,"Uint64Type",(function(){return bt})),n.d(e,"Float32Type",(function(){return Et})),n.d(e,"Float64Type",(function(){return At})),n.d(e,"ReferenceType",(function(){return xt})),n.d(e,"StringType",(function(){return Gt})),n.d(e,"Pointer",(function(){return Kt})),n.d(e,"PointerType",(function(){return Zt})),n.d(e,"ArrayType",(function(){return ue})),n.d(e,"ArgumentDef",(function(){return fe})),n.d(e,"In",(function(){return me})),n.d(e,"Out",(function(){return ve})),n.d(e,"InOut",(function(){return we})),n.d(e,"FunctionPrototype",(function(){return Ee})),n.d(e,"Wasi",(function(){return Pe}));n(2);var r=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.memory=e,this.malloc=n,this.free=r,this.dataView=new DataView(this.memory.buffer)};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.TypedArrayType=e}var e,n,r;return e=t,(n=[{key:"alloc",value:function(t,e){throw new Error("Not Implemented")}},{key:"free",value:function(t,e,n){throw new Error("Not Implemented")}},{key:"marshall",value:function(t,e){throw new Error("Not Implemented")}},{key:"unmarshall",value:function(t,e,n){throw new Error("Not Implemented")}},{key:"copy",value:function(t,e){throw new Error("Not Implemented")}}])&&o(e.prototype,n),r&&o(e,r),t}();function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(i,t);var e,n,r,o=l(i);function i(){return c(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"alloc",value:function(t){return t.malloc(this.TypedArrayType.BYTES_PER_ELEMENT)}},{key:"free",value:function(t,e){e.free(t)}}])&&f(e.prototype,n),r&&f(e,r),i}(i);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}function w(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(i,t);var e,n,r,o=v(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Int8Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setInt8(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getInt8(t)}finally{e.free(t)}}}])&&b(e.prototype,n),r&&b(e,r),i}(p);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=R(t);if(e){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _(this,n)}}function _(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(i,t);var e,n,r,o=T(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Int8Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setInt16(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getInt16(t)}finally{e.free(t)}}}])&&E(e.prototype,n),r&&E(e,r),i}(p);function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N(this,n)}}function N(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(i,t);var e,n,r,o=D(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Int32Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setInt32(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getInt32(t)}finally{e.free(t)}}}])&&A(e.prototype,n),r&&A(e,r),i}(p);function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=F(t);if(e){var o=F(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return V(this,n)}}function V(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(i,t);var e,n,r,o=M(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,BigInt64Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setBigInt64(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getBigInt64(t)}finally{e.free(t)}}}])&&U(e.prototype,n),r&&U(e,r),i}(p);function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=X(t);if(e){var o=X(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W(this,n)}}function W(t,e){return!e||"object"!==Y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(i,t);var e,n,r,o=H(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Uint8Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setUint8(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getUint8(t)}finally{e.free(t)}}}])&&G(e.prototype,n),r&&G(e,r),i}(p);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var o=tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return J(this,n)}}function J(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Z(t,e)}(i,t);var e,n,r,o=$(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Uint16Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setUint16(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getUint16(t)}finally{e.free(t)}}}])&&z(e.prototype,n),r&&z(e,r),i}(p);function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ot(t,e){return(ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function it(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ct(t);if(e){var o=ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ut(this,n)}}function ut(t,e){return!e||"object"!==nt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ft=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ot(t,e)}(i,t);var e,n,r,o=it(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Uint32Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setUint32(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getUint32(t)}finally{e.free(t)}}}])&&rt(e.prototype,n),r&&rt(e,r),i}(p);function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht(t);if(e){var o=ht(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pt(this,n)}}function pt(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ht(t){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(i,t);var e,n,r,o=yt(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,BigUint64Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setBigUint64(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getBigUint64(t)}finally{e.free(t)}}}])&&lt(e.prototype,n),r&&lt(e,r),i}(p);function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gt(t);if(e){var o=gt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ot(this,n)}}function Ot(t,e){return!e||"object"!==mt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(i,t);var e,n,r,o=dt(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Float32Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setFloat32(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getFloat32(t)}finally{e.free(t)}}}])&&vt(e.prototype,n),r&&vt(e,r),i}(p);function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pt(t);if(e){var o=Pt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jt(this,n)}}function jt(t,e){return!e||"object"!==St(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var At=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(i,t);var e,n,r,o=Rt(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,Float64Array)}return e=i,(n=[{key:"marshall",value:function(t,e){var n=this.alloc(e);return e.dataView.setFloat64(n,t),n}},{key:"unmarshall",value:function(t,e){try{return e.dataView.getFloat64(t)}finally{e.free(t)}}}])&&Tt(e.prototype,n),r&&Tt(e,r),i}(p);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ct(t);if(e){var o=Ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kt(this,n)}}function kt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(n,t);var e=Nt(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,Uint32Array)}return n}(i);function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vt(t,e){return(Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yt(t);if(e){var o=Yt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bt(this,n)}}function Bt(t,e){return!e||"object"!==Ut(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vt(t,e)}(i,t);var e,n,r,o=Ft(i);function i(){return Lt(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"free",value:function(t,e){e.free(t)}},{key:"marshall",value:function(t,e){var n=(new TextEncoder).encode(t),r=e.malloc(n.byteLength+1);return new Uint8Array(e.memory.buffer,r,n.byteLength+1).set(n),r}},{key:"unmarshall",value:function(t,e){try{for(var n=new Uint8Array(e.memory.buffer,t),r=0;0!==n[r];)++r;var o=new Uint8Array(e.memory.buffer,t,r);return(new TextDecoder).decode(o)}finally{e.free(t)}}}])&&Mt(e.prototype,n),r&&Mt(e,r),i}(xt);var Kt=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.contents=e};function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zt(t);if(e){var o=zt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qt(this,n)}}function qt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xt(t,e)}(i,t);var e,n,r,o=Qt(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).type=t,e}return e=i,(n=[{key:"free",value:function(t,e){try{var n=e.dataView.getUint32(t);this.type.free(n,e)}finally{e.free(t)}}},{key:"alloc",value:function(t){return t.malloc(Uint32Array.BYTES_PER_ELEMENT)}},{key:"marshall",value:function(t,e){var n=this.alloc(e),r=this.type.marshall(t.contents,e);return e.dataView.setUint32(n,r),n}},{key:"unmarshall",value:function(t,e){try{var n=e.dataView.getUint32(t);return new Kt(this.type.unmarshall(n,e))}finally{e.free(t)}}},{key:"copy",value:function(t,e){return t.contents=e.contents,t}}])&&Wt(e.prototype,n),r&&Wt(e,r),i}(xt);function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t){return function(t){if(Array.isArray(t))return te(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return te(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ie(t);if(e){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(t,e){return!e||"object"!==$t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ie(t){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ue=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(i,t);var e,n,r,o=re(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).type=t,n.length=e,n}return e=i,(n=[{key:"alloc",value:function(t,e){if(null!=this.length&&null!=e&&this.length!==e.length)throw new RangeError("Invalid array length");var n=null!=e?e.length:this.length;if(null==n)throw new RangeError("Unknown length");return t.malloc(n*this.type.TypedArrayType.BYTES_PER_ELEMENT)}},{key:"free",value:function(t,e,n){var r=this;try{var o=null!=n?n.length:this.length;if(null==o)throw new Error("Unknwon length for array");this.type instanceof xt&&new this.type.TypedArrayType(e.memory.buffer,t,o).forEach((function(t){return r.type.free(t,e)}))}finally{e.free(t)}}},{key:"marshall",value:function(t,e){var n=this,r=this.alloc(e,t),o=new this.type.TypedArrayType(e.memory.buffer,r,t.length);return this.type instanceof xt?t.forEach((function(t,r){o[r]=n.type.marshall(t,e)})):o.set(t),r}},{key:"unmarshall",value:function(t,e,n){var r=this;try{var o=null!=n?n.length:this.length;if(null==o)throw new Error("Unknwon length for array");var i=new this.type.TypedArrayType(e.memory.buffer,t,o);return this.type instanceof xt?Array.from(i,(function(t){return r.type.unmarshall(t,e)})):Array.from(i)}finally{e.free(t)}}},{key:"copy",value:function(t,e){return t.splice.apply(t,[0,t.length].concat(Jt(e))),t}}])&&ee(e.prototype,n),r&&ee(e,r),i}(xt);function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var fe=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.isInput=n,this.isOutput=r}var e,n,r;return e=t,(n=[{key:"marshall",value:function(t,e){return this.type instanceof p?t:this.isInput?this.type.marshall(t,e):this.type.alloc(e,t)}},{key:"unmarshall",value:function(t,e,n){if(this.type instanceof p)return t;if(this.isOutput){if(null==n)throw new Error("Out put argument missing");if("number"!=typeof t)throw new Error("Expected address to be a number");var r=this.type.unmarshall(t,e,n);this.type.copy(n,r)}else{if("number"!=typeof t)throw new Error("Expected address to be a number");this.type.free(t,e,n)}}}])&&ce(e.prototype,n),r&&ce(e,r),t}();function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function se(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=be(t);if(e){var o=be(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return he(this,n)}}function he(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function be(t){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var me=function(t){se(n,t);var e=pe(n);function n(t){return le(this,n),e.call(this,t,!0,!1)}return n}(fe),ve=function(t){se(n,t);var e=pe(n);function n(t){return le(this,n),e.call(this,t,!1,!0)}return n}(fe),we=function(t){se(n,t);var e=pe(n);function n(t){return le(this,n),e.call(this,t,!0,!0)}return n}(fe);function de(t){return function(t){if(Array.isArray(t))return Oe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Oe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ee=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.argDefs=e,this.returns=n}var e,n,r;return e=t,(n=[{key:"invoke",value:function(t,e){for(var n=this,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(this.argDefs.length!==o.length)throw new RangeError("Invalid number of arguments");var u=o.map((function(e,r){return n.argDefs[r].marshall(e,t)})),c=e.apply(void 0,de(u));if(o.forEach((function(e,r){return n.argDefs[r].unmarshall(u[r],t,e)})),null!=this.returns)return this.returns.unmarshall(c,t)}}])&&ge(e.prototype,n),r&&ge(e,r),t}(),Se={ESUCCESS:0,ERRNO:{"2BIG":1,ACCES:2,ADDRINUSE:3,ADDRNOTAVAIL:4,AFNOSUPPORT:5,AGAIN:6,ALREADY:7,BADF:8,BADMSG:9,BUSY:10,CANCELED:11,CHILD:12,CONNABORTED:13,CONNREFUSED:14,CONNRESET:15,DEADLK:16,DESTADDRREQ:17,DOM:18,DQUOT:19,EXIST:20,FAULT:21,FBIG:22,HOSTUNREACH:23,IDRM:24,ILSEQ:25,INPROGRESS:26,INTR:27,INVAL:28,IO:29,ISCONN:30,ISDIR:31,LOOP:32,MFILE:33,MLINK:34,MSGSIZE:35,MULTIHOP:36,NAMETOOLONG:37,NETDOWN:38,NETRESET:39,NETUNREACH:40,NFILE:41,NOBUFS:42,NODEV:43,NOENT:44,NOEXEC:45,NOLCK:46,NOLINK:47,NOMEM:48,NOMSG:49,NOPROTOOPT:50,NOSPC:51,NOSYS:52,NOTCONN:53,NOTDIR:54,NOTEMPTY:55,NOTRECOVERABLE:56,NOTSOCK:57,NOTSUP:58,NOTTY:59,NXIO:60,OVERFLOW:61,OWNERDEAD:62,PERM:63,PIPE:64,PROTO:65,PROTONOSUPPORT:66,PROTOTYPE:67,RANGE:68,ROFS:69,SPIPE:70,SRCH:71,STALE:72,TIMEDOUT:73,TXTBSY:74,XDEV:75,NOTCAPABLE:76},FILETYPE:{UNKNOWN:0,BLOCK_DEVICE:1,CHARACTER_DEVICE:2,DIRECTORY:3,REGULAR_FILE:4,SOCKET_DGRAM:5,SOCKET_STREAM:6,SYMBOLIC_LINK:7},FDFLAGS:{APPEND:1,DSYNC:2,NONBLOCK:4,RSYNC:8,SYNC:16},RIGHTS:{FD:{DATASYNC:1n,READ:2n,SEEK:4n,FDSTAT_SET_FLAGS:8n,SYNC:16n,TELL:32n,WRITE:64n,ADVISE:128n,ALLOCATE:256n,READDIR:16384n,FILESTAT_GET:2097152n,FILESTAT_SET_SIZE:4194304n,FILESTAT_SET_TIMES:8388608n},PATH:{CREATE_DIRECTORY:512n,CREATE_FILE:1024n,LINK_SOURCE:2048n,LINK_TARGET:4096n,OPEN:8192n,READLINK:32768n,RENAME_SOURCE:65536n,RENAME_TARGET:131072n,FILESTAT_GET:262144n,FILESTAT_SET_SIZE:524288n,FILESTAT_SET_TIMES:1048576n,SYMLINK:16777216n,REMOVE_DIRECTORY:33554432n,UNLINK_FILE:67108864n},POLL_FD_READWRITE:134217728n,SOCK_SHUTDOWN:268435456n},ADVICE:{NORMAL:0,SEQUENTIAL:1,RANDOM:2,WILLNEED:3,DONTNEED:4,NOREUSE:5}};function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function je(t,e,n){for(var r=e+n;r.includes("\n");){var o=_e(r.split("\n",2),2),i=o[0],u=o[1];t(i),r=u}return r}var Pe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.env=e,this.instance=null,this.memoryManager=null,this.stdoutText="",this.stderrText=""}var e,n,o;return e=t,(n=[{key:"init",value:function(t){this.instance=t,this.memoryManager=new r(t.exports.memory,t.exports.malloc,t.exports.free)}},{key:"environ_get",value:function(t,e){var n=this,r=new TextEncoder;return Object.entries(this.env).map((function(t){var e=_e(t,2),n=e[0],r=e[1];return"".concat(n,"=").concat(r)})).forEach((function(o){n.memoryManager.dataView.setUint32(t,e,!0),t+=4;var i=r.encode(o),u=new Uint8Array(n.memoryManager.memory.buffer,e,i.length+1);e+=u.byteLength})),Se.ESUCCESS}},{key:"environ_sizes_get",value:function(t,e){var n=new TextEncoder,r=Object.entries(this.env).map((function(t){var e=_e(t,2),n=e[0],r=e[1];return"".concat(n,"=").concat(r)})),o=r.reduce((function(t,e){return t+n.encode(e).byteLength+1}),0);return this.memoryManager.dataView.setUint32(t,r.length,!0),this.memoryManager.dataView.setUint32(e,o,!0),Se.ESUCCESS}},{key:"proc_exit",value:function(t){return Se.ESUCCESS}},{key:"fd_close",value:function(t){return Se.ESUCCESS}},{key:"fd_seek",value:function(t,e,n,r,o){return Se.ESUCCESS}},{key:"fd_write",value:function(t,e,n,r){var o=this;if(!(1===t|2===t))return Se.ERRNO.BADF;var i=Array.from({length:n},(function(t,n){var r=e+8*n,i=o.memeoryManager.dataView.getUint32(r,!0),u=o.memeoryManager.dataView.getUint32(r+4,!0);return new Uint8Array(o.memoryManager.memory.buffer,i,u)})),u=new TextDecoder,c=0,f="";return i.forEach((function(t){f+=u.decode(t),c+=t.byteLength})),this.memeoryManager.dataView.setUint32(r,c,!0),1===t?this.stdoutText=je(console.log,this.stdoutText,f):2===t&&(this.stderrText=je(console.error,this.stderrText,f)),Se.ESUCCESS}},{key:"fd_fdstat_get",value:function(t,e){if(!(1===t|2===t))return Se.ERRNO.BADF;if(null==this.memoryManager||null==this.memoryManager.dataView)throw new Error("No memory");return this.memoryManager.dataView.setUint8(e+0,Se.FILETYPE.CHARACTER_DEVICE),this.memoryManager.dataView.setUint32(e+2,Se.FDFLAGS.APPEND,!0),this.memoryManager.dataView.setBigUint64(e+8,Se.RIGHTS.FD_WRITE,!0),this.memoryManager.dataView.setBigUint64(e+16,Se.RIGHTS.FD_WRITE,!0),Se.ESUCCESS}}])&&Te(e.prototype,n),o&&Te(e,o),t}()}])}));